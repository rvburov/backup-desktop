# Руководство пользователя Backup Application

## Содержание
1. [Установка](#установка)
2. [Интерфейс приложения](#интерфейс-приложения)
3. [Первое использование](#первое-использование)
4. [Расширенные настройки](#расширенные-настройки)
5. [Безопасность и защита данных](#безопасность-и-защита-данных)
6. [Решение проблем](#решение-проблем)
7. [FAQ](#faq)

## Установка

### Системные требования
- **Windows**: Windows 10/11, Python 3.6+
- **Linux**: Ubuntu 18.04+, CentOS 7+, Python 3.6+
- **macOS**: macOS 10.14+, Python 3.6+
- 100 МБ свободного места
- Разрешения на чтение/запись файлов

### Установка на Windows
```bash
# Скачайте Python с python.org
pip install PyQt5
python backup_app.py
```

### Установка на Linux
```bash
sudo apt update
sudo apt install python3 python3-pip
pip3 install PyQt5
python3 backup_app.py
```

### Установка на macOS
```bash
brew install python3
pip3 install PyQt5
python3 backup_app.py
```

## Интерфейс приложения

### Главное окно
Приложение имеет интуитивно понятный интерфейс с двумя основными вкладками:

#### Вкладка "Выбор файлов"
- **Вкладки** - возможность создания нескольких наборов файлов для копирования
  - Кнопка "+ Добавить вкладку" для создания новых наборов
  - Возможность закрытия вкладок (кроме последней)
- **Список выбранных папок** - управление директориями для копирования
  - Кнопки: "Добавить папку", "Удалить выбранную", "Очистить список"
- **Список выбранных файлов** - отдельные файлы для резервирования
  - Кнопки: "Добавить файлы", "Удалить выбранный", "Очистить список"
- **Папка сохранения** - выбор места сохранения резервных копий

#### Вкладка "Настройки"
- **Планирование** - настройка автоматического расписания копирования
  - Тип периода: Ежедневно, Еженедельно, Ежемесячно
  - Время копирования
  - День недели/месяца (для соответствующих периодов)
- **Дополнительные настройки** - расширенные параметры:
  - **Копировать файлы из всех вкладок** - одновременное копирование из всех созданных вкладок
  - Копировать содержимое папки (без самой папки)
  - Добавить дату к имени сохраненной копии файла
  - Создавать отдельную папку "Резервное копирование дд-мм-гггг"
  - Запускать приложение при старте системы
- **Сброс настроек** - восстановление настроек по умолчанию

### Панель управления
- **Запустить** - включение автоматического копирования по расписанию
- **Остановить** - остановка автоматического копирования
- **Копировать** - выполнение немедленного ручного копирования
- **Отменить** - отмена текущей операции копирования

## Первое использование

### Шаг 1: Работа с вкладками
1. **Создание вкладок**: Нажмите "+ Добавить вкладку" для создания нового набора файлов
2. **Переименование**: Кликните на заголовок вкладки для редактирования названия
3. **Закрытие**: Используйте крестик на вкладке для закрытия (нельзя закрыть последнюю вкладку)

### Шаг 2: Добавление источников данных
1. Откройте нужную вкладку в разделе "Выбор файлов"
2. Нажмите "Добавить папку" для выбора директорий для резервирования
3. Используйте "Добавить файлы" для выбора отдельных файлов
4. Убедитесь, что выбранные элементы появились в соответствующих списках

### Шаг 3: Выбор папки назначения
1. Нажмите "Выбрать папку" рядом с полем "Папка сохранения"
2. Выберите существующую папку или создайте новую для резервных копий
3. Убедитесь, что на выбранном диске достаточно свободного места

### Шаг 4: Настройка параметров копирования
1. Перейдите на вкладку "Настройки"
2. Настройте дополнительные параметры:
   - **Копировать файлы из всех вкладок** - позволяет выполнять массовое копирование
   - **Копировать содержимое папки** - копирует только файлы из папки, без создания самой папки в назначении
   - **Добавить дату к имени** - предотвращает перезапись файлов, добавляя временную метку
   - **Создавать отдельную папку** - организует копии по датам

### Шаг 5: Настройка расписания (опционально)
1. Выберите тип периода:
   - **Ежедневно** - копирование каждый день в указанное время
   - **Еженедельно** - копирование в выбранный день недели
   - **Ежемесячно** - копирование в указанный день месяца
2. Установите время копирования
3. Для еженедельного/ежемесячного периода укажите соответствующий день

### Шаг 6: Запуск копирования
- **Автоматический режим**: Нажмите "Запустить" для работы по расписанию
- **Ручной режим**: Нажмите "Копировать" для немедленного выполнения
- **Отслеживание прогресса**: Наблюдайте за ходом выполнения в прогресс-баре и логе операций

## Расширенные настройки

### Многовкладочное копирование
**Новая функция**: Копирование из нескольких вкладок одновременно
- Включите опцию "Копировать файлы из всех вкладок"
- Каждая вкладка копируется в свою папку назначения
- Идеально для организации резервных копий разных проектов

### Пакетное копирование
**Альтернативное название**: Массовое копирование из всех профилей
- Одновременная обработка всех настроенных вкладок
- Независимые пути назначения для каждого набора данных
- Сводный прогресс по всем операциям

### Настройка автозапуска
Приложение может автоматически запускаться при старте системы:

1. Установите галочку "Запускать приложение при старте системы"
2. Приложение автоматически настроит автозапуск для вашей ОС:
   - **Windows**: запись в реестр (HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run)
   - **Linux**: создание .desktop файла в ~/.config/autostart/
   - **macOS**: создание plist файла в ~/Library/LaunchAgents/
3. Для отключения снимите галочку

### Стратегии именования файлов
- **Добавить дату к имени** - добавляет временную метку формата "дд.мм.гггг_ЧЧ-ММ-СС" к копируемым файлам, предотвращая перезапись
- **Числовые суффиксы** - при отключенной истории добавляет суффиксы (_(1), _(2)) к конфликтующим файлам
- **Создавать отдельную папку** - создает папку с названием "Резервное копирование дд-мм-гггг" для каждого сеанса копирования

### Режимы копирования папок
- **Копировать всю папку** - сохраняет структуру папок (по умолчанию)
- **Копировать содержимое папки** - копирует только файлы из папки без создания самой папки в месте назначения

### Мониторинг процесса
- **Прогресс-бар** показывает ход копирования больших объемов данных
- **Статусная строка** отображает текущую операцию и следующий запланированный сеанс
- **Лог операций** содержит подробную информацию о всех действиях с временными метками

## Безопасность и защита данных

### Встроенные механизмы безопасности

#### Защита от переполнения путей
- Автоматическое укорачивание слишком длинных имен файлов
- Ограничение максимальной длины путей для совместимости с Windows

#### Безопасная обработка символьных ссылок
- **Символьные ссылки игнорируются** при копировании для предотвращения уязвимостей
- Логирование пропущенных ссылок для прозрачности

#### Защита от traversal-атак
- Проверка относительных путей на наличие последовательностей ".."
- Предотвращение выхода за пределы целевой директории

#### Проверка типов файлов
- Игнорирование специальных файлов устройств
- Копирование только обычных файлов и папок

### Ограничения безопасности
- **Максимальный размер файла**: 2 ГБ
- **Максимальная длина пути**: 240 символов
- **Запрещенные директории**: системные папки (/etc, /bin, C:\Windows и т.д.)

### Мониторинг безопасности
Все события безопасности логируются с пометкой "[SECURITY]" в логе операций:
- Пропущенные символьные ссылки
- Небезопасные пути
- Специальные файлы
- Ошибки проверки прав доступа

## Решение проблем

### Общие проблемы

#### Приложение не запускается
**Ошибка**: `ModuleNotFoundError: No module named 'PyQt5'`
**Решение**: Установите PyQt5: `pip install PyQt5`

#### Нет прав доступа
**Ошибка**: `PermissionError: [Errno 13] Permission denied`
**Решение**: 
- Запустите приложение от имени администратора
- Проверьте права на чтение для исходных папок и запись для папки назначения

#### Недостаточно места
**Ошибка**: Сообщение о недостатке свободного места
**Решение**: 
- Освободите место на целевом диске
- Выберите другой диск для сохранения копий
- Исключите большие файлы из резервирования

#### Файлы не копируются
**Проблема**: В логе сообщение "Нет файлов для копирования"
**Решение**:
- Убедитесь, что выбранные папки и файлы существуют
- Проверьте, что в папках есть файлы (не пустые директории)
- Убедитесь, что у приложения есть права на чтение файлов

### Проблемы с многовкладочным копированием

#### Не копируются все вкладки
**Проблема**: Копируется только текущая вкладка
**Решение**: Убедитесь, что включена опция "Копировать файлы из всех вкладок" в настройках

#### Разные папки назначения
**Особенность**: Каждая вкладка использует свою папку назначения
**Решение**: Проверьте настройки папки сохранения для каждой вкладки отдельно

### Проблемы с пакетным копированием

#### Частичное завершение
**Проблема**: Некоторые вкладки скопированы, другие - нет
**Решение**: Приложение продолжает работу даже при ошибках в отдельных вкладках. Проверьте лог для выявления проблемных вкладок.

#### Несинхронный прогресс
**Особенность**: Прогресс-бар показывает общий прогресс по всем вкладкам
**Решение**: Это ожидаемое поведение. Детальный прогресс по каждой вкладке отображается в логе.

### Проблемы с автозапуском

#### Windows
- Проверьте наличие приложения в списке автозагрузки (Диспетчер задач → Автозагрузка)
- При необходимости настройте вручную через реестр: `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run`

#### Linux
- Проверьте файл `~/.config/autostart/backupapp.desktop`
- Убедитесь, что файл имеет права на выполнение

#### macOS
- Проверьте настройки в System Preferences → Users & Groups → Login Items
- Убедитесь, что приложение добавлено в список автозагрузки

### Проблемы с копированием

#### Дублирование файлов
**Проблема**: Создаются multiple копии файлов
**Решение**: Отключите опцию "Добавить дату к имени" если хотите перезаписывать файлы

#### Длинные пути
**Проблема**: Ошибки при копировании файлов с длинными путями (Windows)
**Решение**: 
- Используйте более короткие имена папок
- Переместите исходные данные ближе к корню диска

#### Символьные ссылки не копируются
**Ожидаемое поведение**: Символьные ссылки пропускаются для безопасности
**Решение**: Если нужно скопировать содержимое ссылки, укажите целевую папку напрямую

## FAQ

### ❓ Сохраняются ли настройки между запусками?
**Да**, все настройки автоматически сохраняются и восстанавливаются при следующем запуске приложения.

### ❓ Можно ли копировать файлы с сетевых дисков?
**Да**, при условии, что у вас есть соответствующие права доступа и стабильное сетевое подключение.

### ❓ Как остановить автоматическое копирование?
Нажмите кнопку "Остановить" на главной панели управления. Это прекратит выполнение копирования по расписанию.

### ❓ Что происходит при конфликте имен файлов?
- При включенной опции "Добавить дату к имени" создаются копии с временными метками
- При отключенной опции добавляются числовые суффиксы (_(1), _(2), ...)
- Исходные файлы никогда не перезаписываются

### ❓ Как просмотреть историю операций?
Вся история записывается в лог в нижней части главного окна приложения. Каждая запись содержит временную метку и подробное описание операции.

### ❓ Что делать если копирование прерывается?
1. Проверьте лог на наличие ошибок
2. Убедитесь в стабильности подключения к сети (для сетевых путей)
3. Проверьте наличие свободного места
4. Убедитесь, что файлы не используются другими программами

### ❓ Поддерживаются ли симлинки и junction points?
**Нет**, для безопасности приложение пропускает символические ссылки и точки соединения. Это защищает от уязвимостей и неожиданного поведения.

### ❓ Можно ли использовать приложение для синхронизации папок?
**Нет**, приложение предназначено specifically для резервного копирования, а не синхронизации. Оно только добавляет файлы в место назначения, не удаляя существующие.

### ❓ Как отменить текущую операцию копирования?
Нажмите кнопку "Отменить" во время выполнения копирования. Операция будет безопасно прервана.

### ❓ Сохраняются ли права доступа и метаданные файлов?
**Да**, при копировании сохраняются временные метки файлов и основные атрибуты. Однако некоторые системные атрибуты могут не сохраняться в зависимости от операционной системы.

### ❓ Почему некоторые файлы не копируются?
Возможные причины:
- Файл является символьной ссылкой
- Файл превышает ограничение в 2 ГБ
- Недостаточно прав доступа
- Файл заблокирован другой программой

### ❓ Как работает многовкладочное копирование?
При включении опции "Копировать файлы из всех вкладок":
- Данные из каждой вкладки копируются в свою папку назначения
- Прогресс отображается суммарно для всех вкладок
- В случае ошибки в одной вкладке, остальные продолжают копироваться

### ❓ Можно ли настроить разные параметры для разных вкладок?
**Да**, каждая вкладка полностью независима и может иметь:
- Свои исходные папки и файлы
- Свою папку назначения
- Свое название (для удобства идентификации)

### ❓ Что такое пакетное копирование?
Это альтернативное название для функции копирования из всех вкладок одновременно. Позволяет выполнять массовое резервное копирование различных наборов данных за одну операцию.
